(this["webpackJsonptodo-app"]=this["webpackJsonptodo-app"]||[]).push([[0],{44:function(t,e,n){},45:function(t,e,n){},47:function(t,e,n){},49:function(t,e,n){},50:function(t,e,n){},60:function(t,e){},61:function(t,e,n){},65:function(t,e,n){},66:function(t,e,n){},67:function(t,e,n){},68:function(t,e,n){},69:function(t,e,n){},70:function(t,e,n){},71:function(t,e,n){"use strict";n.r(e);var a=n(6),c=n.n(a),s=n(37),r=n.n(s),i=(n(44),n(9)),o=(n(45),n(0)),u=n.n(o),l=n(3),b=(n(47),n.p+"static/media/refresh.91424661.svg"),j=n(4);function d(t){var e=t.url,n=t.outline,a=t.small,c=t.refreshAvatar;return Object(j.jsxs)("div",{className:"avatar",children:[Object(j.jsx)("div",{className:"".concat(a?"avatar__wrapper_small":"avatar__wrapper"," ").concat(n?"avatar--outined":""),children:Object(j.jsx)("img",{src:e,alt:"avatar face",className:"avatar__face"})}),!!c&&Object(j.jsx)("button",{className:"avatar__refresh",onClick:function(){c()},children:Object(j.jsx)("img",{src:b,alt:"refresh avatar"})})]})}d.defaultProps={url:null,outline:!1,small:!1,refreshAvatar:null};n(49),n(50);function f(t){var e=t.content;return Object(j.jsx)("span",{className:"text",children:e})}function v(t){var e=t.label,n=t.onClick,a=t.disabled,c=t.icon;return Object(j.jsxs)("button",{className:"button ".concat(a?"button_disabled":""),onClick:n,children:[Object(j.jsx)("img",{src:c,alt:""}),Object(j.jsx)(f,{content:e})]})}v.defaultProps={disabled:!1,icon:""};var O=n(38),m=n(30),h=n(22),x=Object(O.a)({apiKey:"AIzaSyBrV54oJIM0agz-WbQ5epUkCCQoQ6f-J7M",authDomain:"tarot-b3e06.firebaseapp.com",projectId:"tarot-b3e06",storageBucket:"tarot-b3e06.appspot.com",messagingSenderId:"472741955571",appId:"1:472741955571:web:26c8fcc9608d78a28af486",measurementId:"G-2RHRYPTBEH"}),p={db:Object(m.b)(),app:x,functions:Object(h.a)(x)};function g(t){localStorage.setItem("userID",t)}function _(){return localStorage.getItem("userID")}function S(t,e,n){var a={url:t,userID:e,userName:n};return g(e),Object(h.b)(p.functions,"createGame")(a).then((function(t){return t.data})).catch((function(t){throw t.message}))}function w(t,e,n,a){var c={url:t,userID:e,userName:n,gameID:a};return g(e),Object(h.b)(p.functions,"joinGame")(c).then((function(t){return t.data})).catch((function(t){throw t.message}))}function N(t,e,n){var a={gameID:t,userID:e,answer:n};return Object(h.b)(p.functions,"sendResult")(a).then((function(t){return t.data})).catch((function(t){throw t.message}))}var y=n(39);function I(){return Math.random().toString().substring(2)}function k(){return(new y.AvatarGenerator).generateRandomAvatar().replace("Circle","Transparent")}var C=n(12),D=(n(61),n(62).generateUsername());function q(){var t=Object(a.useState)(k()),e=Object(i.a)(t,2),n=e[0],c=e[1],s=Object(a.useState)(D),r=Object(i.a)(s,2),o=r[0],b=r[1],O=Object(a.useState)(!1),m=Object(i.a)(O,2),h=m[0],x=m[1],p=Object(a.useState)(""),g=Object(i.a)(p,2),_=g[0],N=g[1],y=Object(a.useState)(!1),q=Object(i.a)(y,2),Q=q[0],P=q[1],R=Object(C.h)().id,T=!!R,A=Object(a.useContext)(Y),G=function(){var t=Object(l.a)(u.a.mark((function t(){var e;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return P(!0),t.prev=1,t.next=4,S(n,I(),o);case 4:e=t.sent,N(e),x(!0),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),A(t.t0);case 12:P(!1);case 13:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(){return t.apply(this,arguments)}}(),M=function(){var t=Object(l.a)(u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return P(!0),t.prev=1,t.next=4,w(n,I(),null!==o&&void 0!==o?o:D,R);case 4:x(!0),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),A(t.t0);case 10:P(!1);case 11:case"end":return t.stop()}}),t,null,[[1,7]])})));return function(){return t.apply(this,arguments)}}();if(h&&!T)return Object(j.jsx)(C.a,{to:"../lobby/".concat(_)});if(h&&T)return Object(j.jsx)(C.a,{to:"../lobby/".concat(R)});return Object(j.jsx)("div",{className:"page home",children:Object(j.jsxs)("div",{className:"home__container",children:[Object(j.jsxs)("div",{children:[Object(j.jsx)("div",{className:"title",children:Object(j.jsx)(f,{content:"Tarot"})}),T&&Object(j.jsx)("div",{className:"",children:Object(j.jsx)(f,{content:"You've been invited!"})})]}),Object(j.jsxs)("div",{className:"home__avatar_container pseudo_container",children:[Object(j.jsx)(d,{refreshAvatar:function(){c(k())},url:n}),Object(j.jsxs)("div",{className:"home__pseudo_container avatar_container",children:[Object(j.jsx)(f,{content:"Choose a character and a name"}),Object(j.jsx)("input",{type:"text",className:"home__pseudo",onChange:function(t){return b(t.target.value)},placeholder:D}),Object(j.jsx)(v,{disabled:Q,label:T?"Join":"Create game",onClick:T?M:G})]})]})]})})}var Q=function(t){var e=Object(a.useState)(),n=Object(i.a)(e,2),c=n[0],s=n[1],r=Object(a.useState)(!0),o=Object(i.a)(r,2),u=o[0],l=o[1],b=Object(a.useState)(""),j=Object(i.a)(b,2),d=j[0],f=j[1];return Object(a.useEffect)((function(){var e;try{e=Object(m.c)(Object(m.a)(p.db,"games",t),(function(t){s(t.data()),l(!1)}))}catch(d){f(d)}return function(){return e()}}),[t]),{data:c,isPending:u,error:d}},P=n.p+"static/media/cross.6c7c55ca.svg",R=n.p+"static/media/crown.3f6caac5.svg";n(65);function T(){var t,e=Object(a.useState)(""),n=Object(i.a)(e,2),c=n[0],s=n[1],r=Object(a.useState)(!1),o=Object(i.a)(r,2),u=o[0],l=o[1],b=Object(a.useContext)(Y),d=Object(C.h)().id,O=Q(null!==d&&void 0!==d?d:""),m=O.error,x=O.isPending,g=O.data;if(u)return Object(j.jsx)(C.a,{to:"../../"});if(!x&&g&&"start"===(null===g||void 0===g?void 0:g.state))return Object(j.jsx)(C.a,{to:"../../game/".concat(d)});m&&b(m);var S=function(){var t=null===g||void 0===g?void 0:g.users.find((function(t){return t.id===_()}));return!!t&&!!(null===t||void 0===t?void 0:t.admin)};x||!(null===g||void 0===g?void 0:g.users)||(null===g||void 0===g?void 0:g.users.find((function(t){return t.id===_()})))||(console.log(!x,null===g||void 0===g?void 0:g.users,_()),l(!0));var w="Start the game";return window.screen.width<=636&&(w="Start"),Object(j.jsx)("div",{className:"page lobby",children:!x&&Object(j.jsxs)("div",{className:"lobby__container",children:[Object(j.jsx)("div",{className:"title",children:Object(j.jsx)(f,{content:"Tarot"})}),Object(j.jsxs)("div",{className:"lobby__invite",children:[Object(j.jsx)(v,{label:"Invite",onClick:function(){s("");var t="".concat("".concat("localhost"===window.location.hostname?"http://localhost:3000/":"https://tarot-b3e06.firebaseapp.com/"),"invite/").concat(d);navigator.clipboard.writeText(t).then((function(){s("Link copied!")}),(function(t){s("An error has occured")}))}}),Object(j.jsx)(f,{content:c})]}),A(null!==(t=null===g||void 0===g?void 0:g.users)&&void 0!==t?t:[],(function(t){try{!function(t,e){var n={userID:t,gameID:e};Object(h.b)(p.functions,"kickUser")(n).then((function(t){return t.data})).catch((function(t){throw t.message}))}(t,d)}catch(c){b(c)}})),Object(j.jsxs)("div",{className:"lobby__start_container lobby_item_mobile",children:[S()&&Object(j.jsx)("div",{className:"lobby__start_message",children:Object(j.jsx)(f,{content:"Ready to play ?"})}),S()&&Object(j.jsx)(v,{label:w,onClick:function(){!function(t){var e={gameID:t};Object(h.b)(p.functions,"startGame")(e).then((function(t){return t.data})).catch((function(t){throw t.message}))}(d)}})]})]})})}function A(t,e){var n=function(){var e;return!!(null===(e=t.find((function(t){return t.id===_()})))||void 0===e?void 0:e.admin)};return Object(j.jsx)("div",{className:"lobby__list",children:t.map((function(a,c){return Object(j.jsxs)("div",{className:"lobby__item",children:[Object(j.jsx)(d,{url:a.url,small:!0}),Object(j.jsx)("div",{className:"lobby__spacing"}),Object(j.jsx)(f,{content:null===a||void 0===a?void 0:a.name}),(a.admin||n())&&Object(j.jsx)("img",{alt:"remove user",onClick:function(){!function(n){var a=t.find((function(t){return t.id===n})),c=t.find((function(t){return t.id===_()}));a&&!a.admin&&c.admin&&e(n)}(a.id)},src:a.admin?R:P,className:"lobby__svg ".concat(a.admin?"":"lobby__svg_clickable")})]},c)}))})}var G=n(1),M=n(2),B=n(7),J=n(8);n(66);function E(t){var e=t.users;return Object(j.jsx)("div",{children:e.map((function(t){return Object(j.jsx)("div",{className:"waiting",children:Object(j.jsx)(f,{content:"name:".concat(t.name," status:").concat(t.answersState.length>=4?"finished":"wating"," values:").concat(t.answersState)})})}))})}function F(t){var e=t.next,n=Object(a.useState)(2),c=Object(i.a)(n,2),s=c[0],r=c[1];return setTimeout((function(){0===s&&e(),r(s-1)}),1e3),Object(j.jsx)("div",{className:"timer",children:Object(j.jsx)(f,{content:s.toString()})})}n(67),n(68);function L(t){var e=t.label,n=t.type,a=t.onClick;return Object(j.jsx)("button",{className:"buttonQ buttonQ__".concat(n),onClick:function(){a()},children:Object(j.jsx)(f,{content:e})})}function U(t){var e=t.question,n=t.sendResult,c=Object(a.useState)([]),s=Object(i.a)(c,2),r=s[0],o=s[1],u=Object(a.useState)(!1),l=Object(i.a)(u,2),b=l[0],d=l[1];Object(a.useEffect)((function(){d(!1);var t=e[3].map((function(t){return{label:t.value,state:t.state}}));o(t)}),[e]);var v=function(t){console.log("click"),d(!0),setTimeout((function(){n(t.state)}),2e3)};return Object(j.jsxs)("div",{className:"question",children:[Object(j.jsx)("div",{className:"question__header"}),Object(j.jsxs)("div",{className:"question__main",children:[Object(j.jsxs)("div",{className:"question__info",children:[Object(j.jsx)(f,{content:"".concat(e[0]," - ").concat(e[1]).toUpperCase()}),Object(j.jsx)("div",{className:"question__title",children:Object(j.jsx)(f,{content:"".concat(e[2])})})]}),r.length>0&&Object(j.jsxs)("div",{className:"question__groupe",children:[Object(j.jsx)(L,{type:b?r[0].state?"valide":"false":"normal",label:r[0].label,onClick:function(){return v(r[0])}}),Object(j.jsx)(L,{type:b?r[1].state?"valide":"false":"normal",label:r[1].label,onClick:function(){return v(r[1])}}),Object(j.jsx)(L,{type:b?r[2].state?"valide":"false":"normal",label:r[2].label,onClick:function(){return v(r[2])}}),Object(j.jsx)(L,{type:b?r[3].state?"valide":"false":"normal",label:r[3].label,onClick:function(){return v(r[3])}})]})]})]})}L.defaultProps={type:"normal"};n(69),n(70);function z(){var t=Object(C.h)().id,e="Icef7RKtrq5pIMaDGL1e";t&&(null===t||void 0===t?void 0:t.length)>10&&(e=t);var n=Q(e),c=n.error,s=n.isPending,r=n.data,i=Object(a.useContext)(Y);return c&&i(c),Object(j.jsx)("div",{className:"page board",children:!s&&!c&&!!r&&t&&Object(j.jsx)(H,{gameID:t,game:r,showMessage:i})})}var H=function(t){Object(B.a)(n,t);var e=Object(J.a)(n);function n(t){var a;Object(G.a)(this,n),(a=e.call(this,t)).startQuestions=function(){a.setState((function(t){return{subState:"questions"}}))},a.handleResult=function(){var t=Object(l.a)(u.a.mark((function t(e){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N(a.props.gameID,a.state.user.id,e);case 2:if(!(a.state.currentQuestionIndex>=3)){t.next=5;break}return a.setState((function(t){return{subState:"waiting"}})),t.abrupt("return");case 5:a.setState((function(t){return{currentQuestionIndex:t.currentQuestionIndex+1}}));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();var c=t.game.users.find((function(t){return t.id===_()})),s=c.answersState.length>0?"questions":"timer";return 4===c.answersState.length&&(s="waiting"),a.state={currentQuestionIndex:c.answersState.length,subState:s,user:c},a}return Object(M.a)(n,[{key:"render",value:function(){if("timer"===this.state.subState)return Object(j.jsx)(F,{next:this.startQuestions});if("waiting"===this.state.subState)return Object(j.jsx)(E,{users:this.props.game.users});if("questions"===this.state.subState){var t=this.props.game.questions[this.state.currentQuestionIndex];return console.log(this.props.game),Object(j.jsx)(U,{question:[t.category,t.difficulty,t.question,t.answers],sendResult:this.handleResult})}}}]),n}(a.Component),K=n(25),Y=Object(a.createContext)((function(t){}));var V=function(){var t=Object(a.useState)(""),e=Object(i.a)(t,2),n=e[0],c=e[1],s=Object(a.useState)(!1),r=Object(i.a)(s,2),o=r[0],u=r[1];return Object(j.jsxs)(K.a,{children:[Object(j.jsx)("div",{className:"toaster__container ".concat(o&&"toaster__up"),children:Object(j.jsx)("div",{className:"toaster__content",children:Object(j.jsx)(f,{content:n})})}),Object(j.jsx)(Y.Provider,{value:function(t){c(t),u(!0),setTimeout((function(){u(!1)}),3e3)},children:Object(j.jsxs)(C.d,{children:[Object(j.jsx)(C.b,{path:"/lobby/:id",element:Object(j.jsx)(T,{})}),Object(j.jsx)(C.b,{path:"/invite/:id",element:Object(j.jsx)(q,{})}),Object(j.jsx)(C.b,{path:"/game/:id",element:Object(j.jsx)(z,{})}),Object(j.jsx)(C.b,{path:"/",element:Object(j.jsx)(q,{})})]})})]})},W=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,72)).then((function(e){var n=e.getCLS,a=e.getFID,c=e.getFCP,s=e.getLCP,r=e.getTTFB;n(t),a(t),c(t),s(t),r(t)}))};r.a.render(Object(j.jsx)(c.a.StrictMode,{children:Object(j.jsx)(V,{})}),document.getElementById("root")),W()}},[[71,1,2]]]);
//# sourceMappingURL=main.218fc511.chunk.js.map